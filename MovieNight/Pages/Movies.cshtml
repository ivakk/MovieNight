@page "{id:int}"
@model MovieNight.Pages.MoviePageModel
@{
}

<head>
    <meta charset="UTF-8">
    <title>@Model.Movie.Title</title>
    <link rel="stylesheet" href="/css/MoviePage.css">
</head>
<body>
    <div class="movie-page">
        <header class="movie-header">
            <div class="header-content">
                <h1 class="movie-title">@Model.Movie.Title</h1>
                <div class="movie-subtitle">
                    <span class="original-title">Original title: @Model.Movie.Title |</span>
                    <span class="bubble">@Model.Movie.Year</span>
                    <span class="bubble">Movie</span>
                    <span class="bubble">@Model.Movie.Length min</span>
                </div>
            </div>
        </header>

        <main class="movie-main">
            <div class="media-container">
                <div class="poster-container">
                    <img src="@Model.Movie.ImageLink" alt="@Model.Movie.Title" class="movie-poster">
                </div>
                <div class="trailer-container">
                    <iframe class="movie-trailer" src="@Model.Movie.TrailerLink" title="@Model.Movie.Title"
                             frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
                    </iframe>
                </div>
            </div>
        </main>

        <aside class="movie-sidebar">
            <div class="movie-content">
                <div class="movie-description-and-actions">
                    <div class="movie-description">
                        <p>@Model.Movie.Description</p>
                        <div class="movie-details">
                            <div class="movie-detail">Director: Nicolas Winding Refn</div>
                            <div class="movie-detail">Country: @Model.Movie.Country</div>
                            <div class="movie-detail">Category: @Model.Movie.Category</div>
                            <div class="movie-detail">Year: @Model.Movie.Year</div>
                        </div>
                    </div>
                    <div class="movie-actions">
                        <!-- Star Rating System -->
                        <div class="rate-label">Your Rating:</div>
                        <div class="rating">
                            <input type='radio' hidden name='rate' id='rating_5' data-idx='0'>
                            <label for='rating_5'></label>

                            <input type='radio' hidden name='rate' id='rating_4' data-idx='1'>
                            <label for='rating_4'></label>

                            <input type='radio' hidden name='rate' id='rating_3' data-idx='2'>
                            <label for='rating_3'></label>

                            <input type='radio' hidden name='rate' id='rating_2' data-idx='3'>
                            <label for='rating_2'></label>

                            <input type='radio' hidden name='rate' id='rating_1' data-idx='4'>
                            <label for='rating_1'></label>
                        </div>


                        <!-- Watchlist Button -->
                        <form method="post" asp-page-handler="ToggleWatchLater" asp-route-movieId="@Model.Movie.Id">
                            <input type="hidden" name="movieId" value="@Model.Movie.Id" />
                            <button type="submit" class="button watchlist-button">
                                @Model.WatchLaterButtonText
                            </button>
                        </form>
                        <form method="post" asp-page-handler="ToggleWatching" asp-route-movieId="@Model.Movie.Id">
                            <input type="hidden" name="movieId" value="@Model.Movie.Id" />
                            <button type="submit" class="button currently-watching-button">
                                @Model.WatchingButtonText
                            </button>
                        </form>
                        <form method="post" asp-page-handler="ToggleFinished" asp-route-movieId="@Model.Movie.Id">
                            <input type="hidden" name="movieId" value="@Model.Movie.Id" />
                            <button type="submit" class="button finished-button">
                                @Model.FinishedButtonText
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="comment-section">
                <h3>Comments</h3>
                <form method="post" asp-page-handler="Comment" asp-route-movieId="@Model.Movie.Id">
                    <textarea asp-for="CommentLeft" placeholder="Leave a comment... "></textarea>
                    <input type="submit" value="Post Comment" class="button comment-button" style="background-color: rgb(117, 54, 112); color: white;"/>
                </form>

                <!-- Display comments -->
                @foreach (var comment in Model.Comments)
                {
                    <div class="comment">
                        <div class="comment-header">
                            <a href="" class="comment-user">@comment.Username</a>
                            <span class="comment-date">@comment.CommentDate.ToString("dd/MM/yyyy")</span>
                        </div>
                        <div class="comment-body">@comment.Information</div>
                        @if (Model.CanDeleteComment(comment.UserId))
                        {
                            <form method="post" asp-page-handler="DeleteComment" asp-route-id="@Model.Movie.Id" asp-route-commentId="@comment.Id">
                                <button type="submit" class="delete-comment-button" title="Delete">
                                    &#x1F5D1; <!-- Unicode for trash bin -->
                                </button>
                            </form>
                        }
                    </div>
                }
            </div>
        </aside>
    </div>
</body>


